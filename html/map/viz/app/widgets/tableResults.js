function sortedIndex(e,a){for(var t=0,o=e.length;o>t;){var n=t+o>>>1;e[n]["Company Name"]<a["Company Name"]?t=n+1:o=n}return t}define(["table/TableController","widgets/CompanyPopup","react"],function(e,a,t){"use strict";var o=[],n=[],r={},i=React.createClass({displayName:"tableResults",showPopup:function(e,t){document.getElementById("popup-area").style.display="block",document.getElementById("popup-area").style.left=t.target.clientWidth+t.target.offsetLeft+"px",document.getElementById("popup-area").style.top=t.target.offsetTop+"px";var o=e.props.data;r.name=o["Company Name"],r.country=o.Country,r.profileID=o.profileID;var n=[{value:o.Country,label:"Country"},{value:o.City,label:"City"},{value:o["Founding Year"],label:"Founding Year"},{value:o.Size,label:"Size"},{value:o["Organization Type"],label:"Organization Type"},{value:o.URL,label:"URL"},{value:o.Description,label:"Description"},{value:o["Industry Category"],label:"Category"},{value:o["Entry Based On"],label:"Entry Based On"},{value:o["Data Use"],label:"Data Use"}];"1"==o.use_advocacy&&n.push({label:"Application",value:"Advocacy: "+o.use_advocacy_desc}),"1"==o.use_prod_srvc&&n.push({label:"Application",value:"New Products and Services: "+o.use_prod_srvc_desc}),"1"==o.use_org_opt&&n.push({label:"Application",value:"Organizational Optimization: "+o.use_org_opt_desc}),"1"==o.use_research&&n.push({label:"Application",value:"Research: "+o.use_research_desc}),"1"==o.use_other&&n.push({label:"Application",value:"Other: "+o.use_other_desc}),React.render(React.createElement(a,{keys:{profileID:{value:o.profileID},items:n,showContent:!0,title:{label:o["Company Name"],selected:!0,toggle:!1}}}),document.getElementById("company-popup"))},componentDidMount:function(){},hidePopup:function(e,a){document.getElementById("popup-area").style.display="none"},sendToEdit:function(){var e=r.profileID,a="http://odetest.govready.org/map/company/"+e+"/edit";window.open(a,"_blank")},exportTableDataJSON:function(){var e=JSON.stringify(o,null,4),a=new Date,t=a.getDate(),n=a.getMonth()+1,r=a.getFullYear();10>t&&(t="0"+t),10>n&&(n="0"+n);var a=t+"_"+n+"_"+r,i=new Blob([e],{type:"text/plain;charset=utf-8"});fileSaveAs(i,"Open Data Impact Map _ Data Export _ "+a+".txt")},exportTableData:function(){var e=_.map(o,_.clone);delete e[0].profileID;var a=[];a.push(Object.keys(e[0])),_.forEach(e,function(e){_.forEach(e,function(a,t){e[t]=String(e[t]).replace(/,/g," - "),e[t]=String(e[t]).replace(/(\r\n|\n|\r)/gm," ")}),a.push([e.Region,e.Country,e["Company Name"],e["Organization Type"],e["Industry Category"],e.Description,e.URL,e.City,e["State/Region"],e["Founding Year"],e.Size,e["Data Use"],e.Advocacy,e["Advocacy Description"],e["Product/Service"],e["Product/Service Description"],e["Organizational Optimization"],e["Organizational Optimization Description"],e.Research,e["Research Description"],e.Other,e["Use - Other Description"],e["Entry Based On"]]),_.forEach(a,function(e,t){_.forEach(e,function(e,o){"null"==e&&(a[t][o]=" ")})})});var t="";a.forEach(function(e,o){var n=e.join(",");t+=o<a.length?n+"\n":n});var n=new Date,r=n.getDate(),i=n.getMonth()+1,s=n.getFullYear();10>r&&(r="0"+r),10>i&&(i="0"+i);var n=r+"_"+i+"_"+s;fileSaveAs(new Blob([t],{type:"text/csv;charset=UTF-8"}),"Open Data Impact Map _ Data Export _ "+n+".csv")},render:function(){var e=this.props;o=[],n=[{columnName:"Company Name",visible:!0},{columnName:"Region",visible:!0},{columnName:"Country",visible:!0},{columnName:"Organization Type",visible:!0},{columnName:"Industry Category",visible:!0},{columnName:"Description",visible:!0,cssClassName:"description-column"},{columnName:"Data Use",visible:!0}];var a=["Company Name","Region","Country","Organization Type","Industry Category","Description","Data Use"];return _.forEach(e.keys,function(e){var a=e.attributes,t={Region:a.org_hq_country_region,Country:a.org_hq_country,"Company Name":a.org_name,"Organization Type":a.org_type,"Industry Category":a.industry_id,Description:a.org_description,URL:a.org_url,City:a.org_hq_city,"State/Region":a.org_hq_st_prov,"Founding Year":a.org_year_founded,Size:a.org_size_id,"Data Use":a.dataCell,Advocacy:1==a.use_advocacy?"TRUE":"FALSE","Advocacy Description":a.use_advocacy_desc,"Product/Service":1==a.use_prod_srvc?"TRUE":"FALSE","Product/Service Description":a.use_prod_srvc_desc,"Organizational Optimization":1==a.use_org_opt?"TRUE":"FALSE","Organizational Optimization Description":a.use_org_opt_desc,Research:1==a.use_research?"TRUE":"FALSE","Research Description":a.use_research_desc,Other:1==a.use_other?"TRUE":"FALSE","Use - Other Description":a.use_other_desc,"Entry Based On":a.org_profile_category};o.splice(sortedIndex(o,t),0,t)}),React.createElement("div",{id:"results-ontainer",className:"results-container"},React.createElement("div",{id:"table-area",className:"table-area"},React.createElement(Griddle,{results:o,columnMetadata:n,columns:a,onRowClick:this.showPopup,enableInfiniteScroll:!1,resultsPerPage:9,useFixedHeader:!0,tableClassName:"table"}),React.createElement("div",{id:"popup-area",className:"table-company-popup"},React.createElement("span",{className:"close-popup",onClick:this.hidePopup},"X"),React.createElement("div",{id:"company-popup"}))))}});return i});